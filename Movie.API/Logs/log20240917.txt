2024-09-17 00:50:31.384 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 00:50:32.001 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 00:50:32.002 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 00:50:32.005 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 00:50:32.005 +07:00 [INF] Hosting environment: Development
2024-09-17 00:50:32.005 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 00:50:32.273 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 00:50:32.430 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 158.1509ms
2024-09-17 00:50:32.440 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 00:50:32.440 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 00:50:32.444 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 4.0915ms
2024-09-17 00:50:32.477 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.3109ms
2024-09-17 00:50:32.688 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 00:50:32.796 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/favicon-32x32.png - null null
2024-09-17 00:50:32.805 +07:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-09-17 00:50:32.805 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/favicon-32x32.png - 200 628 image/png 9.5083ms
2024-09-17 00:50:32.822 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 133.6859ms
2024-09-17 00:50:40.195 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 00:50:40.501 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 00:50:40.502 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 00:50:40.509 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 00:50:40.509 +07:00 [INF] Hosting environment: Development
2024-09-17 00:50:40.509 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 00:50:45.256 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 00:50:45.626 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 370.3766ms
2024-09-17 00:50:45.922 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 00:50:45.925 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 00:50:45.964 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 63.8164ms
2024-09-17 00:50:46.193 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 277.9569ms
2024-09-17 00:50:46.262 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 00:50:46.562 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 299.3288ms
2024-09-17 00:51:02.413 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 46
2024-09-17 00:51:02.486 +07:00 [INF] CORS policy execution successful.
2024-09-17 00:51:02.492 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:51:02.522 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 00:51:03.076 +07:00 [INF] Executing action method Movie.API.Controllers.AccountController.Login (Movie.API) - Validation state: "Valid"
2024-09-17 00:51:12.693 +07:00 [INF] Executed DbCommand (133ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 00:51:13.045 +07:00 [INF] Executed action method Movie.API.Controllers.AccountController.Login (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 9958.6253ms.
2024-09-17 00:51:13.078 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 00:51:13.114 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 10571.0462ms
2024-09-17 00:51:13.118 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:51:13.136 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 10725.4375ms
2024-09-17 00:51:23.975 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 00:51:24.002 +07:00 [INF] CORS policy execution successful.
2024-09-17 00:51:24.004 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:51:24.006 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 00:51:24.047 +07:00 [INF] Executing action method Movie.API.Controllers.AccountController.Login (Movie.API) - Validation state: "Valid"
2024-09-17 00:51:29.626 +07:00 [INF] Executed DbCommand (1,474ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 00:51:29.756 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 00:51:29.817 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 00:51:30.227 +07:00 [INF] Executed action method Movie.API.Controllers.AccountController.Login (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 6175.7914ms.
2024-09-17 00:51:30.251 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 00:51:30.260 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 6243.9341ms
2024-09-17 00:51:30.261 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:51:30.271 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 6304.6153ms
2024-09-17 00:52:01.368 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/track/all - null null
2024-09-17 00:52:01.383 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.TrackController.GetTracks (Movie.API)'
2024-09-17 00:52:01.390 +07:00 [INF] Route matched with {action = "GetTracks", controller = "Track"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] GetTracks() on controller Movie.API.Controllers.TrackController (Movie.API).
2024-09-17 00:52:01.411 +07:00 [INF] Executing action method Movie.API.Controllers.TrackController.GetTracks (Movie.API) - Validation state: "Valid"
2024-09-17 00:52:01.467 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__request_UserId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[CreateDate], [t].[FilmId], [t].[IsActive], [t].[LastModifiedDate], [t].[Status], [t].[UserId]
FROM [Tracks] AS [t]
WHERE [t].[UserId] = @__request_UserId_0
2024-09-17 00:52:01.603 +07:00 [INF] Executed action method Movie.API.Controllers.TrackController.GetTracks (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 190.4693ms.
2024-09-17 00:52:01.628 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.DataRespone'.
2024-09-17 00:52:01.649 +07:00 [INF] Executed action Movie.API.Controllers.TrackController.GetTracks (Movie.API) in 247.5108ms
2024-09-17 00:52:01.651 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.TrackController.GetTracks (Movie.API)'
2024-09-17 00:52:01.659 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/api/track/all - 200 null application/json; charset=utf-8 292.7614ms
2024-09-17 00:52:24.048 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 00:52:24.341 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 00:52:24.341 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 00:52:24.349 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 00:52:24.349 +07:00 [INF] Hosting environment: Development
2024-09-17 00:52:24.349 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 00:52:28.317 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 00:52:28.559 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 246.0144ms
2024-09-17 00:52:28.589 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 00:52:28.594 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 00:52:28.611 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 18.9707ms
2024-09-17 00:52:28.671 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.8294ms
2024-09-17 00:52:28.711 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 00:52:28.866 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 155.4403ms
2024-09-17 00:52:39.633 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 00:52:39.698 +07:00 [INF] CORS policy execution successful.
2024-09-17 00:52:39.705 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:52:39.730 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 00:52:39.958 +07:00 [INF] Executing action method Movie.API.Controllers.AccountController.Login (Movie.API) - Validation state: "Valid"
2024-09-17 00:52:46.341 +07:00 [INF] Executed DbCommand (55ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 00:52:46.589 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 00:52:46.652 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 00:52:46.783 +07:00 [INF] Executed action method Movie.API.Controllers.AccountController.Login (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 6813.9624ms.
2024-09-17 00:52:46.816 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 00:52:46.878 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 7109.4776ms
2024-09-17 00:52:46.883 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:52:46.904 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 7271.5454ms
2024-09-17 00:53:12.734 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/track/all - null null
2024-09-17 00:53:12.758 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.TrackController.GetTracks (Movie.API)'
2024-09-17 00:53:12.764 +07:00 [INF] Route matched with {action = "GetTracks", controller = "Track"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] GetTracks() on controller Movie.API.Controllers.TrackController (Movie.API).
2024-09-17 00:53:17.536 +07:00 [INF] Executing action method Movie.API.Controllers.TrackController.GetTracks (Movie.API) - Validation state: "Valid"
2024-09-17 00:54:31.383 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 00:54:31.712 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 00:54:31.712 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 00:54:31.719 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 00:54:31.719 +07:00 [INF] Hosting environment: Development
2024-09-17 00:54:31.719 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 00:54:32.651 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 00:54:32.860 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 213.6486ms
2024-09-17 00:54:35.155 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 00:54:35.156 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 00:54:35.170 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 14.3277ms
2024-09-17 00:54:35.306 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 151.0295ms
2024-09-17 00:54:35.392 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 00:54:35.634 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 241.329ms
2024-09-17 00:54:48.029 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 00:54:48.085 +07:00 [INF] CORS policy execution successful.
2024-09-17 00:54:48.090 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:54:48.115 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 00:54:48.326 +07:00 [INF] Executing action method Movie.API.Controllers.AccountController.Login (Movie.API) - Validation state: "Valid"
2024-09-17 00:54:55.926 +07:00 [INF] Executed DbCommand (56ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 00:54:56.168 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 00:54:56.243 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 00:54:56.360 +07:00 [INF] Executed action method Movie.API.Controllers.AccountController.Login (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 8022.4373ms.
2024-09-17 00:54:56.394 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 00:54:56.428 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 8292.5773ms
2024-09-17 00:54:56.430 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:54:56.447 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 8418.5223ms
2024-09-17 00:55:14.913 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/track/all - null null
2024-09-17 00:55:14.944 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2024-09-17 00:55:14.950 +07:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2024-09-17 00:55:14.953 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/api/track/all - 302 0 null 48.672ms
2024-09-17 00:55:14.960 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/Account/Login?ReturnUrl=%2Fapi%2Ftrack%2Fall - null null
2024-09-17 00:55:14.973 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/Account/Login?ReturnUrl=%2Fapi%2Ftrack%2Fall - 404 0 null 11.9387ms
2024-09-17 00:55:14.977 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7039/Account/Login, Response status code: 404
2024-09-17 00:55:20.476 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/track/all - null null
2024-09-17 00:55:20.496 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2024-09-17 00:55:20.498 +07:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2024-09-17 00:55:20.502 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/api/track/all - 302 0 null 24.4652ms
2024-09-17 00:55:20.508 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/Account/Login?ReturnUrl=%2Fapi%2Ftrack%2Fall - null null
2024-09-17 00:55:20.519 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/Account/Login?ReturnUrl=%2Fapi%2Ftrack%2Fall - 404 0 null 9.8601ms
2024-09-17 00:55:20.522 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7039/Account/Login, Response status code: 404
2024-09-17 00:56:48.780 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 00:56:48.822 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 43.1613ms
2024-09-17 00:56:48.867 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 00:56:48.868 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 00:56:48.877 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 9.1616ms
2024-09-17 00:56:48.911 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.6458ms
2024-09-17 00:56:48.948 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 00:56:48.991 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.16ms
2024-09-17 00:57:07.948 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 00:57:07.967 +07:00 [INF] CORS policy execution successful.
2024-09-17 00:57:07.969 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:57:07.975 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 00:57:10.991 +07:00 [INF] Executing action method Movie.API.Controllers.AccountController.Login (Movie.API) - Validation state: "Valid"
2024-09-17 00:57:11.064 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 00:57:11.167 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 00:57:11.189 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 00:57:11.200 +07:00 [INF] Executed action method Movie.API.Controllers.AccountController.Login (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 206.0329ms.
2024-09-17 00:57:11.219 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 00:57:11.231 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 3245.2387ms
2024-09-17 00:57:11.232 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 00:57:11.241 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 3295.9451ms
2024-09-17 00:57:26.857 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/track/all - null null
2024-09-17 00:57:27.038 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.TrackController.GetTracks (Movie.API)'
2024-09-17 00:57:27.044 +07:00 [INF] Route matched with {action = "GetTracks", controller = "Track"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] GetTracks() on controller Movie.API.Controllers.TrackController (Movie.API).
2024-09-17 00:57:27.064 +07:00 [INF] Executing action method Movie.API.Controllers.TrackController.GetTracks (Movie.API) - Validation state: "Valid"
2024-09-17 00:59:37.744 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 00:59:38.005 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 00:59:38.005 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 00:59:38.012 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 00:59:38.012 +07:00 [INF] Hosting environment: Development
2024-09-17 00:59:38.012 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 00:59:39.117 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 00:59:39.318 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 205.4678ms
2024-09-17 00:59:41.456 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 00:59:41.457 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 00:59:41.469 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 13.4745ms
2024-09-17 00:59:41.535 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 78.2026ms
2024-09-17 00:59:41.569 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 00:59:41.721 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 151.6475ms
2024-09-17 01:00:01.314 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 01:00:01.381 +07:00 [INF] CORS policy execution successful.
2024-09-17 01:00:01.386 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 01:00:01.415 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 01:00:01.661 +07:00 [INF] Executing action method Movie.API.Controllers.AccountController.Login (Movie.API) - Validation state: "Valid"
2024-09-17 01:00:03.517 +07:00 [INF] Executed DbCommand (77ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 01:00:03.834 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 01:00:03.918 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 01:00:04.003 +07:00 [INF] Executed action method Movie.API.Controllers.AccountController.Login (Movie.API), returned result Microsoft.AspNetCore.Mvc.ObjectResult in 2328.3278ms.
2024-09-17 01:00:04.047 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 01:00:04.096 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 2660.13ms
2024-09-17 01:00:04.099 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 01:00:04.121 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 2806.6938ms
2024-09-17 01:00:17.932 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/track/all - null null
2024-09-17 01:00:18.025 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.TrackController.GetTracks (Movie.API)'
2024-09-17 01:00:18.031 +07:00 [INF] Route matched with {action = "GetTracks", controller = "Track"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] GetTracks() on controller Movie.API.Controllers.TrackController (Movie.API).
2024-09-17 01:00:18.053 +07:00 [INF] Executing action method Movie.API.Controllers.TrackController.GetTracks (Movie.API) - Validation state: "Valid"
2024-09-17 09:17:04.342 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:17:04.712 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:17:04.712 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:17:04.714 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:17:04.715 +07:00 [INF] Hosting environment: Development
2024-09-17 09:17:04.715 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:17:05.113 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:17:05.309 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 197.3596ms
2024-09-17 09:17:05.345 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:17:05.345 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:17:05.352 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 6.9071ms
2024-09-17 09:17:05.387 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 41.6446ms
2024-09-17 09:17:05.853 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:17:06.042 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 188.283ms
2024-09-17 09:18:29.066 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/comment/all?filmid=1 - null null
2024-09-17 09:18:29.099 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.CommentController.GetCommnets (Movie.API)'
2024-09-17 09:18:29.121 +07:00 [INF] Route matched with {action = "GetCommnets", controller = "Comment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] GetCommnets(Int32) on controller Movie.API.Controllers.CommentController (Movie.API).
2024-09-17 09:18:31.830 +07:00 [INF] Executed DbCommand (106ms) [Parameters=[@__request_FilmId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreateDate], [c].[FilmId], [c].[IsActive], [c].[IsLocked], [c].[LastModifiedDate], [c].[Status], [c].[UserId], [c].[content]
FROM [Comments] AS [c]
WHERE [c].[FilmId] = @__request_FilmId_0
2024-09-17 09:18:31.984 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.DataRespone'.
2024-09-17 09:18:32.004 +07:00 [INF] Executed action Movie.API.Controllers.CommentController.GetCommnets (Movie.API) in 2879.6813ms
2024-09-17 09:18:32.004 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.CommentController.GetCommnets (Movie.API)'
2024-09-17 09:18:32.010 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/api/comment/all?filmid=1 - 200 null application/json; charset=utf-8 2944.7956ms
2024-09-17 09:20:10.111 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:20:10.227 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:20:10.227 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:20:10.230 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:20:10.231 +07:00 [INF] Hosting environment: Development
2024-09-17 09:20:10.231 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:20:10.554 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:20:10.693 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 140.3469ms
2024-09-17 09:20:10.704 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:20:10.704 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:20:10.708 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 4.144ms
2024-09-17 09:20:10.734 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.4319ms
2024-09-17 09:20:10.923 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:20:11.088 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 165.1598ms
2024-09-17 09:20:28.048 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/comment/add - application/json 111
2024-09-17 09:20:28.082 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:20:28.087 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:20:28.105 +07:00 [INF] Route matched with {action = "AddComment", controller = "Comment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddComment(Movie.API.Requests.AddCommentRequest) on controller Movie.API.Controllers.CommentController (Movie.API).
2024-09-17 09:20:28.284 +07:00 [INF] Executed action Movie.API.Controllers.CommentController.AddComment (Movie.API) in 173.8742ms
2024-09-17 09:20:28.285 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:20:28.335 +07:00 [ERR] An unhandled exception has occurred while executing the request.
AutoMapper.AutoMapperMappingException: Missing type map configuration or unsupported mapping.

Mapping types:
AddCommentRequest -> AddCommentCommand
Movie.API.Requests.AddCommentRequest -> Movie.API.Features.Comments.AddCommentCommand
   at lambda_method11(Closure, AddCommentRequest, AddCommentCommand, ResolutionContext)
   at Movie.API.Controllers.CommentController.AddComment(AddCommentRequest model) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Controllers\CommentController.cs:line 32
   at lambda_method6(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-17 09:20:28.339 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/comment/add - 500 null text/plain; charset=utf-8 290.7836ms
2024-09-17 09:28:02.429 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:28:02.729 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:28:02.730 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:28:02.732 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:28:02.732 +07:00 [INF] Hosting environment: Development
2024-09-17 09:28:02.732 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:28:03.254 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:28:03.402 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 148.9398ms
2024-09-17 09:28:03.411 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:28:03.411 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:28:03.417 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 5.6126ms
2024-09-17 09:28:03.438 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.5314ms
2024-09-17 09:28:03.679 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:28:03.818 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 138.6416ms
2024-09-17 09:28:11.726 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:28:11.731 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 5.5043ms
2024-09-17 09:28:12.046 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:28:12.048 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:28:12.048 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 0.5794ms
2024-09-17 09:28:12.057 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 11.277ms
2024-09-17 09:28:12.206 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:28:12.242 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 35.2201ms
2024-09-17 09:29:04.475 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/comment/add - application/json 111
2024-09-17 09:29:04.498 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:29:04.500 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:29:04.517 +07:00 [INF] Route matched with {action = "AddComment", controller = "Comment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddComment(Movie.API.Requests.AddCommentRequest) on controller Movie.API.Controllers.CommentController (Movie.API).
2024-09-17 09:29:06.872 +07:00 [INF] Executed DbCommand (158ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 450), @p7='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Comments] ([CreateDate], [FilmId], [IsActive], [IsLocked], [LastModifiedDate], [Status], [UserId], [content])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2024-09-17 09:29:06.931 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Movie.API.Infrastructure.Data.MovieDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Comments'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:77d7762b-dd31-470b-a814-97f6d004488b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Comments'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:77d7762b-dd31-470b-a814-97f6d004488b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-09-17 09:29:06.937 +07:00 [INF] Executed action Movie.API.Controllers.CommentController.AddComment (Movie.API) in 2417.7226ms
2024-09-17 09:29:06.938 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:29:06.952 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Comments'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:77d7762b-dd31-470b-a814-97f6d004488b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Movie.API.Infrastructure.Repositories.GenericRepository`1.SaveAsync() in D:\Workplace\MoviesApp\Movie-api\Movie.API\Infrastructure\Repositories\GenericRepository.cs:line 55
   at Movie.API.Features.Comments.AddCommentCommandHandler.Handle(AddCommentCommand request, CancellationToken cancellationToken) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Features\Comments\AddCommentCommandHandler.cs:line 28
   at Movie.API.Controllers.CommentController.AddComment(AddCommentRequest model) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Controllers\CommentController.cs:line 33
   at lambda_method6(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-17 09:29:06.962 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/comment/add - 500 null text/plain; charset=utf-8 2486.4717ms
2024-09-17 09:34:02.441 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:34:02.550 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:34:02.550 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:34:02.552 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:34:02.552 +07:00 [INF] Hosting environment: Development
2024-09-17 09:34:02.552 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:34:03.058 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:34:03.198 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 141.5148ms
2024-09-17 09:34:03.205 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:34:03.205 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:34:03.209 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 4.5199ms
2024-09-17 09:34:03.227 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.5229ms
2024-09-17 09:34:03.501 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:34:03.640 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 138.8592ms
2024-09-17 09:34:19.162 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 09:34:19.187 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:34:19.190 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:34:19.206 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 09:34:21.071 +07:00 [INF] Executed DbCommand (50ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 09:34:21.312 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 09:34:21.347 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 09:34:21.794 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 09:34:21.814 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 2604.3778ms
2024-09-17 09:34:21.814 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:34:21.821 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 2658.5633ms
2024-09-17 09:35:00.922 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:35:01.029 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:35:01.029 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:35:01.031 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:35:01.031 +07:00 [INF] Hosting environment: Development
2024-09-17 09:35:01.031 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:35:01.527 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:35:01.686 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 160.3951ms
2024-09-17 09:35:01.702 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:35:01.702 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:35:01.707 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 4.3338ms
2024-09-17 09:35:01.729 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.1505ms
2024-09-17 09:35:01.995 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:35:02.164 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 169.4346ms
2024-09-17 09:35:27.410 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 09:35:27.443 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:35:27.446 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:35:27.468 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 09:35:29.002 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 09:35:29.281 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 09:35:29.326 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 09:35:29.366 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 09:35:29.394 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 1922.2331ms
2024-09-17 09:35:29.394 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:35:29.400 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 1989.3689ms
2024-09-17 09:35:57.852 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/comment/add - application/json 111
2024-09-17 09:35:57.854 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:35:58.179 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:35:58.183 +07:00 [INF] Route matched with {action = "AddComment", controller = "Comment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddComment(Movie.API.Requests.AddCommentRequest) on controller Movie.API.Controllers.CommentController (Movie.API).
2024-09-17 09:35:58.468 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 450), @p7='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Comments] ([CreateDate], [FilmId], [IsActive], [IsLocked], [LastModifiedDate], [Status], [UserId], [content])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2024-09-17 09:35:58.496 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Movie.API.Infrastructure.Data.MovieDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Comments_Films_FilmId". The conflict occurred in database "MovieDB", table "dbo.Films", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:69ca58be-26c0-43fe-a5d5-b2bc07f3184b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Comments_Films_FilmId". The conflict occurred in database "MovieDB", table "dbo.Films", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:69ca58be-26c0-43fe-a5d5-b2bc07f3184b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-09-17 09:35:58.497 +07:00 [INF] Executed action Movie.API.Controllers.CommentController.AddComment (Movie.API) in 313.8725ms
2024-09-17 09:35:58.497 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:35:58.511 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Comments_Films_FilmId". The conflict occurred in database "MovieDB", table "dbo.Films", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:69ca58be-26c0-43fe-a5d5-b2bc07f3184b
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Movie.API.Infrastructure.Repositories.GenericRepository`1.SaveAsync() in D:\Workplace\MoviesApp\Movie-api\Movie.API\Infrastructure\Repositories\GenericRepository.cs:line 55
   at Movie.API.Features.Comments.AddCommentCommandHandler.Handle(AddCommentCommand request, CancellationToken cancellationToken) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Features\Comments\AddCommentCommandHandler.cs:line 28
   at Movie.API.Controllers.CommentController.AddComment(AddCommentRequest model) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Controllers\CommentController.cs:line 38
   at lambda_method232(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-17 09:35:58.517 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/comment/add - 500 null text/plain; charset=utf-8 665.7088ms
2024-09-17 09:38:16.123 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/api/film/all - null null
2024-09-17 09:38:16.124 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.FilmController.GetFilms (Movie.API)'
2024-09-17 09:38:16.141 +07:00 [INF] Route matched with {action = "GetFilms", controller = "Film"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] GetFilms() on controller Movie.API.Controllers.FilmController (Movie.API).
2024-09-17 09:38:16.168 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [f].[Id], [f].[CountryId], [f].[CreateDate], [f].[Description], [f].[Image], [f].[IsActive], [f].[LastModifiedDate], [f].[Name], [f].[NumberOfEpisodes], [f].[ReleaseYear], [f].[ScheduleId], [f].[Status], [f].[ViewCount]
FROM [Films] AS [f]
2024-09-17 09:38:16.211 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.DataRespone'.
2024-09-17 09:38:16.219 +07:00 [INF] Executed action Movie.API.Controllers.FilmController.GetFilms (Movie.API) in 78.333ms
2024-09-17 09:38:16.219 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.FilmController.GetFilms (Movie.API)'
2024-09-17 09:38:16.220 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/api/film/all - 200 null application/json; charset=utf-8 96.9164ms
2024-09-17 09:38:31.981 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/comment/add - application/json 112
2024-09-17 09:38:31.982 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:38:31.984 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:38:31.984 +07:00 [INF] Route matched with {action = "AddComment", controller = "Comment"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddComment(Movie.API.Requests.AddCommentRequest) on controller Movie.API.Controllers.CommentController (Movie.API).
2024-09-17 09:38:31.992 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = Boolean), @p4='?' (DbType = DateTime2), @p5='?' (DbType = Int32), @p6='?' (Size = 450), @p7='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Comments] ([CreateDate], [FilmId], [IsActive], [IsLocked], [LastModifiedDate], [Status], [UserId], [content])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2024-09-17 09:38:32.008 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.AddCommentResponse'.
2024-09-17 09:38:32.010 +07:00 [INF] Executed action Movie.API.Controllers.CommentController.AddComment (Movie.API) in 25.9779ms
2024-09-17 09:38:32.010 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.CommentController.AddComment (Movie.API)'
2024-09-17 09:38:32.010 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/comment/add - 200 null application/json; charset=utf-8 29.2099ms
2024-09-17 09:45:18.271 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:45:18.395 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:45:18.395 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:45:18.397 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:45:18.398 +07:00 [INF] Hosting environment: Development
2024-09-17 09:45:18.398 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:45:18.786 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:45:18.954 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 169.0231ms
2024-09-17 09:45:18.964 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:45:18.964 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:45:18.969 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 5.7983ms
2024-09-17 09:45:18.994 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.078ms
2024-09-17 09:45:19.303 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:45:19.509 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 205.6629ms
2024-09-17 09:45:45.523 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 09:45:45.585 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:45:45.591 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:45:45.637 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 09:45:49.064 +07:00 [INF] Executed DbCommand (93ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 09:45:49.600 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 09:45:49.713 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 09:45:49.837 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 09:45:49.889 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 4242.4199ms
2024-09-17 09:45:49.890 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:45:49.908 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 4384.9819ms
2024-09-17 09:46:05.924 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/History/add - application/json 82
2024-09-17 09:46:05.926 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:46:05.927 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.HistoryController.AddHistory (Movie.API)'
2024-09-17 09:46:05.932 +07:00 [INF] Route matched with {action = "AddHistory", controller = "History"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddHistory(Movie.API.Requests.AddHistoryRequest) on controller Movie.API.Controllers.HistoryController (Movie.API).
2024-09-17 09:46:06.746 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Histories] ([CreateDate], [FilmId], [IsActive], [LastModifiedDate], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-09-17 09:46:06.821 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Movie.API.Infrastructure.Data.MovieDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Histories'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6ad51ced-721d-421d-b7b7-0cd4fddd1325
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Histories'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6ad51ced-721d-421d-b7b7-0cd4fddd1325
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-09-17 09:46:06.823 +07:00 [INF] Executed action Movie.API.Controllers.HistoryController.AddHistory (Movie.API) in 890.848ms
2024-09-17 09:46:06.823 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.HistoryController.AddHistory (Movie.API)'
2024-09-17 09:46:06.855 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Histories'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:6ad51ced-721d-421d-b7b7-0cd4fddd1325
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Movie.API.Infrastructure.Repositories.GenericRepository`1.SaveAsync() in D:\Workplace\MoviesApp\Movie-api\Movie.API\Infrastructure\Repositories\GenericRepository.cs:line 55
   at Movie.API.Features.Histories.AddHistoryCommandHandler.Handle(AddHistoryCommand request, CancellationToken cancellationToken) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Features\Histories\AddHistoryCommandHandler.cs:line 26
   at Movie.API.Controllers.HistoryController.AddHistory(AddHistoryRequest model) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Controllers\HistoryController.cs:line 36
   at lambda_method232(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-17 09:46:06.866 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/History/add - 500 null text/plain; charset=utf-8 941.7676ms
2024-09-17 09:48:12.765 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:48:12.885 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:48:12.885 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:48:12.887 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:48:12.888 +07:00 [INF] Hosting environment: Development
2024-09-17 09:48:12.888 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:48:13.322 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:48:13.483 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 163.1867ms
2024-09-17 09:48:13.492 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:48:13.494 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:48:13.500 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 5.723ms
2024-09-17 09:48:13.521 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.5922ms
2024-09-17 09:48:13.804 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:48:13.993 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 189.0984ms
2024-09-17 09:48:23.769 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 09:48:23.832 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:48:23.839 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:48:23.879 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 09:48:27.233 +07:00 [INF] Executed DbCommand (93ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 09:48:27.789 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 09:48:27.889 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 09:48:28.005 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 09:48:28.058 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 4170.0818ms
2024-09-17 09:48:28.059 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:48:28.072 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 4303.2329ms
2024-09-17 09:48:49.771 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/History/add - application/json 82
2024-09-17 09:48:49.774 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:48:49.774 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.HistoryController.AddHistory (Movie.API)'
2024-09-17 09:48:49.780 +07:00 [INF] Route matched with {action = "AddHistory", controller = "History"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddHistory(Movie.API.Requests.AddHistoryRequest) on controller Movie.API.Controllers.HistoryController (Movie.API).
2024-09-17 09:48:50.623 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Histories] ([CreateDate], [FilmId], [IsActive], [LastModifiedDate], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-09-17 09:48:50.691 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Movie.API.Infrastructure.Data.MovieDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Histories'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:52ffe3e6-2260-411b-9caa-c791251fd4fb
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Histories'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:52ffe3e6-2260-411b-9caa-c791251fd4fb
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2024-09-17 09:48:50.693 +07:00 [INF] Executed action Movie.API.Controllers.HistoryController.AddHistory (Movie.API) in 912.9599ms
2024-09-17 09:48:50.693 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.HistoryController.AddHistory (Movie.API)'
2024-09-17 09:48:50.727 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserId', table 'MovieDB.dbo.Histories'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:52ffe3e6-2260-411b-9caa-c791251fd4fb
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Movie.API.Infrastructure.Repositories.GenericRepository`1.SaveAsync() in D:\Workplace\MoviesApp\Movie-api\Movie.API\Infrastructure\Repositories\GenericRepository.cs:line 55
   at Movie.API.Features.Histories.AddHistoryCommandHandler.Handle(AddHistoryCommand request, CancellationToken cancellationToken) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Features\Histories\AddHistoryCommandHandler.cs:line 26
   at Movie.API.Controllers.HistoryController.AddHistory(AddHistoryRequest model) in D:\Workplace\MoviesApp\Movie-api\Movie.API\Controllers\HistoryController.cs:line 36
   at lambda_method232(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-09-17 09:48:50.739 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/History/add - 500 null text/plain; charset=utf-8 967.7224ms
2024-09-17 09:49:25.525 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 09:49:25.652 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 09:49:25.652 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 09:49:25.655 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 09:49:25.655 +07:00 [INF] Hosting environment: Development
2024-09-17 09:49:25.655 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 09:49:25.782 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 09:49:25.944 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 163.2112ms
2024-09-17 09:49:25.952 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 09:49:25.952 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 09:49:25.957 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 4.4698ms
2024-09-17 09:49:25.979 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.4554ms
2024-09-17 09:49:26.073 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 09:49:26.239 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 166.7105ms
2024-09-17 09:49:37.920 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/account/login - application/json 50
2024-09-17 09:49:38.003 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:49:38.009 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:49:38.068 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] Login(Movie.API.Requests.LoginRequest) on controller Movie.API.Controllers.AccountController (Movie.API).
2024-09-17 09:49:41.649 +07:00 [INF] Executed DbCommand (83ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccessFailedCount], [u].[Avatar], [u].[ConcurrencyStamp], [u].[DisplayName], [u].[Email], [u].[EmailConfirmed], [u].[LockoutEnabled], [u].[LockoutEnd], [u].[NormalizedEmail], [u].[NormalizedUserName], [u].[PasswordHash], [u].[PhoneNumber], [u].[PhoneNumberConfirmed], [u].[RefreshToken], [u].[RefreshTokenExpiry], [u].[SecurityStamp], [u].[TwoFactorEnabled], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[NormalizedUserName] = @__normalizedUserName_0
2024-09-17 09:49:42.254 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[RoleId]
FROM [UserRoles] AS [u]
WHERE [u].[UserId] = @__user_Id_0
2024-09-17 09:49:42.363 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__roleId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[Id], [r].[ConcurrencyStamp], [r].[Name], [r].[NormalizedName]
FROM [Roles] AS [r]
WHERE [r].[Id] = @__roleId_0
2024-09-17 09:49:42.505 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.LoginRespone'.
2024-09-17 09:49:42.558 +07:00 [INF] Executed action Movie.API.Controllers.AccountController.Login (Movie.API) in 4479.969ms
2024-09-17 09:49:42.559 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.AccountController.Login (Movie.API)'
2024-09-17 09:49:42.573 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/account/login - 200 null application/json; charset=utf-8 4653.3554ms
2024-09-17 09:50:07.401 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7039/api/History/add - application/json 82
2024-09-17 09:50:07.404 +07:00 [INF] CORS policy execution successful.
2024-09-17 09:50:07.524 +07:00 [INF] Executing endpoint 'Movie.API.Controllers.HistoryController.AddHistory (Movie.API)'
2024-09-17 09:50:07.535 +07:00 [INF] Route matched with {action = "AddHistory", controller = "History"}. Executing controller action with signature System.Threading.Tasks.Task`1[Movie.API.Responses.Response] AddHistory(Movie.API.Requests.AddHistoryRequest) on controller Movie.API.Controllers.HistoryController (Movie.API).
2024-09-17 09:50:08.368 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Histories] ([CreateDate], [FilmId], [IsActive], [LastModifiedDate], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2024-09-17 09:50:08.435 +07:00 [INF] Executing ObjectResult, writing value of type 'Movie.API.Responses.AddHistoryResponse'.
2024-09-17 09:50:08.442 +07:00 [INF] Executed action Movie.API.Controllers.HistoryController.AddHistory (Movie.API) in 906.5215ms
2024-09-17 09:50:08.442 +07:00 [INF] Executed endpoint 'Movie.API.Controllers.HistoryController.AddHistory (Movie.API)'
2024-09-17 09:50:08.443 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7039/api/History/add - 200 null application/json; charset=utf-8 1041.905ms
2024-09-17 11:14:24.443 +07:00 [INF] User profile is available. Using 'C:\Users\phuoc\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-17 11:14:24.560 +07:00 [INF] Now listening on: https://localhost:7039
2024-09-17 11:14:24.561 +07:00 [INF] Now listening on: http://localhost:5203
2024-09-17 11:14:24.563 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-17 11:14:24.563 +07:00 [INF] Hosting environment: Development
2024-09-17 11:14:24.563 +07:00 [INF] Content root path: D:\Workplace\MoviesApp\Movie-api\Movie.API
2024-09-17 11:14:25.096 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/index.html - null null
2024-09-17 11:14:25.289 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/index.html - 200 null text/html;charset=utf-8 194.3728ms
2024-09-17 11:14:25.304 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - null null
2024-09-17 11:14:25.308 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_framework/aspnetcore-browser-refresh.js - 200 13754 application/javascript; charset=utf-8 4.5905ms
2024-09-17 11:14:25.317 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/_vs/browserLink - null null
2024-09-17 11:14:25.349 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/_vs/browserLink - 200 null text/javascript; charset=UTF-8 31.0527ms
2024-09-17 11:14:25.519 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - null null
2024-09-17 11:14:25.672 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7039/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 153.1431ms
